# SpaceCli - Mac OS 磁盘空间分析工具

一个强大的Mac OS命令行工具，用于分析磁盘空间健康度并找出占用空间最大的目录。

## 功能特性

- 🔍 **磁盘健康度检测** - 评估磁盘空间使用情况，提供健康状态建议
- 📊 **目录大小分析** - 递归分析目录大小，找出占用空间最大的文件夹
- 💻 **系统信息显示** - 显示Mac系统版本和基本信息
- 📄 **报告导出** - 将分析结果导出为JSON格式报告
- ⚡ **高性能** - 优化的算法，快速分析大型文件系统
- 🎯 **灵活配置** - 支持自定义分析路径和显示数量

## 安装

### 方法1：直接使用（推荐）

```bash
# 克隆或下载项目
git clone <repository-url>
cd MacDiskSpace

# 给脚本添加执行权限
chmod +x space_cli.py

# 运行
python3 space_cli.py
```

### 方法2：创建全局命令

```bash
# 复制到系统路径
sudo cp space_cli.py /usr/local/bin/space-cli
sudo chmod +x /usr/local/bin/space-cli

# 现在可以在任何地方使用
space-cli
```

## 使用方法

### 基本用法

```bash
# 分析根目录（默认）
python3 space_cli.py

# 分析指定路径
python3 space_cli.py -p /Users/username

# 显示前10个最大的目录
python3 space_cli.py -n 10
```

### 高级用法

```bash
# 只显示磁盘健康状态
python3 space_cli.py --health-only

# 只显示目录分析
python3 space_cli.py --directories-only

# 导出分析报告
python3 space_cli.py --export disk_report.json

# 分析用户目录并导出报告
python3 space_cli.py -p /Users -n 15 --export user_analysis.json
```

### 命令行参数

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `-p, --path` | 要分析的路径 | `/` |
| `-n, --top-n` | 显示前N个最大的目录 | `20` |
| `--health-only` | 只显示磁盘健康状态 | - |
| `--directories-only` | 只显示目录分析 | - |
| `--export FILE` | 导出报告到JSON文件 | - |
| `--version` | 显示版本信息 | - |
| `-h, --help` | 显示帮助信息 | - |

## 输出示例

### 磁盘健康状态
```
============================================================
🔍 磁盘空间健康度分析
============================================================
磁盘路径: /
总容量: 500.0 GB
已使用: 400.0 GB
可用空间: 100.0 GB
使用率: 80.0%
健康状态: ⚠️ 警告
建议: 磁盘空间不足，建议清理一些文件
```

### 目录分析
```
============================================================
📊 占用空间最大的目录
============================================================
显示前 20 个最大的目录:

 1. /Applications
    大小: 15.2 GB (3.04%)

 2. /Users/username/Library
    大小: 8.5 GB (1.70%)

 3. /System
    大小: 6.8 GB (1.36%)
```

## 健康状态说明

- ✅ **良好** - 磁盘使用率 < 80%
- ⚠️ **警告** - 磁盘使用率 80-90%
- 🚨 **严重** - 磁盘使用率 > 90%

## 性能优化

- 使用递归算法高效计算目录大小
- 跳过无法访问的系统文件和隐藏文件
- 支持中断操作（Ctrl+C）
- 内存优化的文件遍历

## 故障排除

### 权限问题
如果遇到权限错误，可以尝试：
```bash
# 使用sudo运行（谨慎使用）
sudo python3 space_cli.py

# 或者分析用户目录
python3 space_cli.py -p /Users/$(whoami)
```

### 性能问题
对于大型文件系统，分析可能需要较长时间：
- 使用 `--directories-only` 跳过健康检查
- 减少 `-n` 参数值
- 分析特定子目录而不是根目录

## 系统要求

- macOS 10.12 或更高版本
- Python 3.6 或更高版本
- 足够的磁盘空间用于临时文件

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request来改进这个工具！

## 更新日志

### v1.0.0
- 初始版本发布
- 基本的磁盘健康度检测
- 目录大小分析功能
- JSON报告导出
- 命令行参数支持
